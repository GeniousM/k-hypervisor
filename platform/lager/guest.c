#include <vm_map.h>
#include <size.h>

/*  label, ipa, pa, size, attr */
struct memdesc_t vm0_device_md[] = {
#if 0
    { "v2m_serial0", 0xE6E60000, 0xE6E60000, SZ_64K, MEMATTR_DEVICE_MEMORY, 1 },
    { "gicd", CFG_GIC_BASE_PA | 0x1000, CFG_GIC_BASE_PA | 0x1000, SZ_4K, MEMATTR_DEVICE_MEMORY, 0 },
    { "gicc", CFG_GIC_BASE_PA | 0x2000, CFG_GIC_BASE_PA | 0x6000, SZ_8K, MEMATTR_DEVICE_MEMORY, 1 },
    {"start", 0x40000000, 0x40000000, SZ_1M, MEMATTR_NORMAL_WB_CACHEABLE, 1 },
    { 0, 0, 0, 0, 0, 0 }
#else
    { "gicd", CFG_GIC_BASE_PA | 0x1000, CFG_GIC_BASE_PA | 0x1000, SZ_4K, MEMATTR_DEVICE_MEMORY, 0 },
    { "gicc", CFG_GIC_BASE_PA | 0x2000, CFG_GIC_BASE_PA | 0x6000, SZ_8K, MEMATTR_DEVICE_MEMORY, 1 },
    //{ "interrupt-controller", 0xf1001000, 0xf1001000, 0x1000, MEMATTR_DEVICE_MEMORY, 0 },
    //{ "interrupt-controller", 0xf1002000, 0xf1006000, 0x2000, MEMATTR_DEVICE_MEMORY, 1 },
    // { "interrupt-controller", 0xf1004000, 0xf1004000, 0x2000, MEMATTR_DEVICE_MEMORY, 0 },
    // { "interrupt-controller", 0xf1006000, 0xf1006000, 0x2000, MEMATTR_DEVICE_MEMORY, 0 },

    { "gpio", 0xe6050000, 0xe6050000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "gpio", 0xe6051000, 0xe6051000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "gpio", 0xe6052000, 0xe6052000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "gpio", 0xe6053000, 0xe6053000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "gpio", 0xe6054000, 0xe6054000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "gpio", 0xe6055000, 0xe6054000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "thermal", 0xe61f0000, 0xe61f0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "timer", 0xffca0000, 0xffca0000, 0x2000, MEMATTR_DEVICE_MEMORY, 1 },
    { "timer", 0xe6130000, 0xe6130000, 0x2000, MEMATTR_DEVICE_MEMORY, 1 },

    { "interrupt-controller", 0xe61c0000, 0xe61c0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "dma-controller", 0xe6700000, 0xe6700000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xe6720000, 0xe6720000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xec720000, 0xec720000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xec700000, 0xec700000, 0x10000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xec740000, 0xec720000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xe65a0000, 0xe65a0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "dma-controller", 0xe65b0000, 0xe65b0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "i2c", 0xe6508000, 0xe6508000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "i2c", 0xe6518000, 0xe6518000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "i2c", 0xe6530000, 0xe6530000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "i2c", 0xe6540000, 0xe6540000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "i2c", 0xe6500000, 0xe6500000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "i2c", 0xe6510000, 0xe6510000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "i2c", 0xe6520000, 0xe6520000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "i2c", 0xe60b0000, 0xe60b0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "mmc", 0xee200000, 0xee200000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "mmc", 0xee220000, 0xee220000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "pfc", 0xe6060000, 0xe6060000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "sd", 0xee100000, 0xee100000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sd", 0xee120000, 0xee120000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sd", 0xee140000, 0xee140000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sd", 0xee160000, 0xee160000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "serial", 0xe6c40000, 0xe6c40000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe6c50000, 0xe6c50000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe6c60000, 0xe6c60000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "serial", 0xe6c20000, 0xe6c20000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe6c30000, 0xe6c30000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe6ce0000, 0xe6ce0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "serial", 0xe6e60000, 0xe6e60000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe6e68000, 0xe6e68000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe62c0000, 0xe62c0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "serial", 0xe62c8000, 0xe62c8000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "ethernet", 0xee700000, 0xee700000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "ethernet", 0xe6800000, 0xe6800000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "sata", 0xee300000, 0xee300000, 0x2000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sata", 0xee500000, 0xee500000, 0x2000, MEMATTR_DEVICE_MEMORY, 1 },

    { "usb", 0xe6590000, 0xe6590000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "usb-phy", 0xe6590100, 0xe6590100, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "video", 0xe6ef0000, 0xe6ef0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "video", 0xe6ef1000, 0xe6ef1000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "video", 0xe6ef2000, 0xe6ef2000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "video", 0xe6ef3000, 0xe6ef3000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "vsp1", 0xfe920000, 0xfe920000, 0x8000, MEMATTR_DEVICE_MEMORY, 1 },
    { "vsp1", 0xfe928000, 0xfe928000, 0x8000, MEMATTR_DEVICE_MEMORY, 1 },
    { "vsp1", 0xfe930000, 0xfe930000, 0x8000, MEMATTR_DEVICE_MEMORY, 1 },
    { "vsp1", 0xfe938000, 0xfe938000, 0x8000, MEMATTR_DEVICE_MEMORY, 1 },

    { "display", 0xfeb00000, 0xfeb00000, 0x70000, MEMATTR_DEVICE_MEMORY, 1 },
    { "display", 0xfeb90000, 0xfeb90000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "display", 0xfeb94000, 0xfeb94000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "can", 0xe6e80000, 0xe6e80000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "can", 0xe6e88000, 0xe6e88000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "jpeg-codec", 0xfe980000, 0xfe980000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },

    { "cpg_clocks", 0xe6150000, 0xe6150000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "spi", 0xe6b10000, 0xe6b10000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "spi", 0xe6e20000, 0xe6e20000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "spi", 0xe6e10000, 0xe6e10000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "spi", 0xe6e00000, 0xe6e00000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "spi", 0xe6c90000, 0xe6c90000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "usb", 0xee000000, 0xee000000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "pci", 0xee090000, 0xee090000, 0x1100, MEMATTR_DEVICE_MEMORY, 1 },
    { "pci", 0xee0b0000, 0xee0b0000, 0x1100, MEMATTR_DEVICE_MEMORY, 1 },
    { "pci", 0xee0d0000, 0xee0d0000, 0x1100, MEMATTR_DEVICE_MEMORY, 1 },

    { "pcie", 0xfe000000, 0xfe000000, 0x80000, MEMATTR_DEVICE_MEMORY, 1 },

    { "sound", 0xec500000, 0xec500000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sound", 0xec5a0000, 0xec5a0000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sound", 0xec540000, 0xec540000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sound", 0xec541000, 0xec541000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "sound", 0xec740000, 0xec740000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "mmu", 0xe6280000, 0xe6280000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "mmu", 0xe6290000, 0xe6290000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "mmu", 0xe6740000, 0xe6740000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { "mmu", 0xec680000, 0xec680000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "mmu", 0xfe951000, 0xfe951000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },
    { "mmu", 0xffc80000, 0xffc80000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    {"meram", 0xe8080000, 0xe8080000, SZ_1M, MEMATTR_DEVICE_MEMORY, 1 },
    {"start", 0x40000000, 0x40000000, SZ_256M, MEMATTR_NORMAL_WB_CACHEABLE, 1 },

    {"reset", 0xe6160000, 0xe6160000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },

    {"arm-generic-counter", 0xe6080000, 0xe6080000, 0x20000, MEMATTR_DEVICE_MEMORY, 1 },

    {"inter-connect-ram1", 0xe63c0000, 0xe63c0000, 0x50000, MEMATTR_DEVICE_MEMORY, 1 },

    {"sysc", 0xe6180000, 0xe6180000, 0x40000, MEMATTR_DEVICE_MEMORY, 1 },

    {"PRR", 0xff000000, 0xff000000, 0x1000, MEMATTR_DEVICE_MEMORY, 1 },

    { 0, 0, 0, 0, 0, 0 }
#endif
};

struct memdesc_t vm1_device_md[] = {
    { "v2m_serial0", 0xE6E60000, 0xE6E60000, SZ_64K, MEMATTR_DEVICE_MEMORY, 1 },
    { "gicd", CFG_GIC_BASE_PA | 0x1000, CFG_GIC_BASE_PA | 0x1000, SZ_4K, MEMATTR_DEVICE_MEMORY, 0 },
    { "gicc", CFG_GIC_BASE_PA | 0x2000, CFG_GIC_BASE_PA | 0x6000, SZ_8K, MEMATTR_DEVICE_MEMORY, 1 },
    {"start", 0x40000000, 0x50000000, SZ_1M, MEMATTR_NORMAL_WB_CACHEABLE, 1 },
    { 0, 0, 0, 0, 0, 0 }
};

struct memdesc_t vm2_device_md[] = {
    { "v2m_serial0", 0xE6E60000, 0xE6E60000, SZ_64K, MEMATTR_DEVICE_MEMORY, 1 },
    { "gicd", CFG_GIC_BASE_PA | 0x1000, CFG_GIC_BASE_PA | 0x1000, SZ_4K, MEMATTR_DEVICE_MEMORY, 0 },
    { "gicc", CFG_GIC_BASE_PA | 0x2000, CFG_GIC_BASE_PA | 0x6000, SZ_8K, MEMATTR_DEVICE_MEMORY, 1 },
    {"start", 0x40000000, 0x60000000, SZ_1M, MEMATTR_NORMAL_WB_CACHEABLE, 1 },
    { 0, 0, 0, 0, 0, 0 }
};

struct memdesc_t *vm_mmap[NUM_GUESTS_STATIC];


void setup_vm_mmap(void)
{
    // TODO(wonseok): it will be replaced by DTB.
    vm_mmap[0] = vm0_device_md;
    vm_mmap[1] = vm1_device_md;
    vm_mmap[2] = vm2_device_md;
}
